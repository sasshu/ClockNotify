let t=0,i=0;const s=new BroadcastChannel("sound-connection"),o=async()=>{"Notification"in self&&Notification.permission==="granted"&&await a()},a=async()=>{self.registration.showNotification("ClockNotify",{body:`${i}時になりました。`,icon:"/logo.png",tag:"hourlyNotification"}),s.postMessage("play-sound")};self.addEventListener("install",()=>{console.log("ServiceWorker installed"),self.skipWaiting()});self.addEventListener("message",n=>{n.data==="play"?self.setTimeout(()=>{t=self.setInterval(async()=>{const e=new Date;e.getMinutes()===0&&e.getSeconds()===0&&(i=e.getHours(),await o())},1e3)},1e3-new Date().getUTCMilliseconds()):n.data==="pause"&&(self.clearInterval(t),t=0)});
