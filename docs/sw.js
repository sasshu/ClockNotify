let n=0,o=0;const a=new BroadcastChannel("sound-connection"),t=globalThis,s=async()=>{"Notification"in t&&Notification.permission==="granted"&&await c()},c=async()=>{t.registration.showNotification("ClockNotify",{body:`${o}時になりました。`,icon:"/logo.png",tag:"hourlyNotification"}),a.postMessage("play-sound")};t.addEventListener("install",()=>{console.log("ServiceWorker installed"),t.skipWaiting()});t.addEventListener("message",i=>{i.data==="play"?t.setTimeout(()=>{n=t.setInterval(async()=>{const e=new Date;e.getMinutes()===0&&e.getSeconds()===0&&(o=e.getHours(),await s())},1e3)},1e3-new Date().getUTCMilliseconds()):i.data==="pause"&&(t.clearInterval(n),n=0)});
